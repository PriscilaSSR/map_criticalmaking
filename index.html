<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GLOBAL AI INTELLIGENCE | FINANCIAL LAYER</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --us-color: #00f2ff;
            --cn-color: #ff3e3e;
            --bg-glass: rgba(5, 5, 5, 0.92);
            --border: 1px solid rgba(255, 255, 255, 0.15);
            --neon-glow: 0 0 10px rgba(0, 242, 255, 0.3);
            --money-green: #00ff9d;
        }

        body { margin: 0; background: #000; font-family: 'JetBrains Mono', monospace; color: #ccc; overflow: hidden; }
        
        #map { height: 100vh; width: 100vw; z-index: 1; filter: grayscale(100%) contrast(1.2) brightness(0.8); }

        /* SCANLINE EFFECT */
        body::after {
            content: " ";
            display: block; position: absolute; top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 2; background-size: 100% 2px, 3px 100%; pointer-events: none;
        }

        /* UI PANELS */
        .ui-panel {
            position: absolute; z-index: 1000; background: var(--bg-glass);
            border: var(--border); backdrop-filter: blur(8px); padding: 15px;
        }

        /* HEADER */
        .top-bar {
            top: 20px; left: 20px; right: 20px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 2px solid #333;
        }
        .h-title { font-weight: 700; color: #fff; letter-spacing: 2px; font-size: 18px; }
        .h-sub { font-size: 10px; color: var(--money-green); margin-top: 4px; }

        /* FILTER BUTTONS */
        .controls { top: 110px; left: 20px; display: flex; flex-direction: column; gap: 8px; width: 160px; }
        .btn-filter {
            background: rgba(255,255,255,0.05); border: 1px solid #444; color: #888;
            padding: 8px 12px; cursor: pointer; font-family: inherit; font-size: 10px;
            text-align: left; transition: 0.3s; text-transform: uppercase;
        }
        .btn-filter:hover, .btn-filter.active { background: #fff; color: #000; border-color: #fff; }
        .btn-filter.us.active { background: var(--us-color); border-color: var(--us-color); }
        .btn-filter.cn.active { background: var(--cn-color); border-color: var(--cn-color); }

        /* RIGHT SIDEBAR (STATS) */
        .sidebar {
            top: 110px; right: 20px; bottom: 40px; width: 360px;
            overflow-y: auto; border-left: 2px solid #333;
        }

        .stat-box { margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #333; }
        .stat-label { font-size: 9px; color: #666; text-transform: uppercase; margin-bottom: 5px; }
        
        /* FINANCIAL BARS */
        .money-bar-container { display: flex; align-items: center; margin-bottom: 6px; font-size: 10px; }
        .money-label { width: 80px; color: #fff; }
        .money-track { flex-grow: 1; background: #222; height: 6px; margin: 0 10px; position: relative; }
        .money-fill { height: 100%; background: var(--money-green); }
        .money-val { width: 60px; text-align: right; color: var(--money-green); }

        .co-list-item {
            padding: 12px; border-bottom: 1px solid #222; cursor: pointer;
            transition: all 0.2s;
        }
        .co-list-item:hover { background: rgba(255,255,255,0.05); padding-left: 15px; }
        .co-header { display: flex; justify-content: space-between; margin-bottom: 4px; }
        .co-name { color: #fff; font-weight: bold; font-size: 13px; }
        .co-money { color: var(--money-green); font-size: 11px; }
        .co-detail { font-size: 10px; color: #888; display: flex; gap: 10px; }
        .source-link { color: #555; text-decoration: none; border-bottom: 1px dotted #555; }
        .source-link:hover { color: #fff; border-color: #fff; }

        /* MAP ELEMENTS */
        .custom-marker {
            width: 10px; height: 10px; border-radius: 50%;
            background: #000; border: 2px solid #fff;
            box-shadow: 0 0 15px currentColor;
            transition: all 0.3s;
        }
        .leaflet-popup-content-wrapper {
            background: rgba(10,10,10,0.95); border: 1px solid var(--money-green); color: #fff;
            font-family: 'JetBrains Mono', monospace; font-size: 11px;
            border-radius: 4px; width: 280px;
        }
        .leaflet-popup-tip { background: #111; border-top: 1px solid var(--money-green); }

        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #333; }
    </style>
</head>
<body>

<div id="map"></div>

<div class="ui-panel top-bar">
    <div>
        <div class="h-title">GLOBAL AI WAR ROOM</div>
        <div class="h-sub">CAPITAL EXPENDITURE & VALUATION TRACKER // 2026 DATA</div>
    </div>
    <div style="text-align:right">
        <div style="font-size: 24px; color: var(--money-green); font-weight:bold;">$3.2T</div>
        <div style="font-size: 9px; color: #666;">EST. GLOBAL AI CAPEX (2025-2028)</div>
    </div>
</div>

<div class="ui-panel controls">
    <div class="stat-label">TACTICAL FILTERS</div>
    <button class="btn-filter active" onclick="filterMap('all')">ALL UNITS</button>
    <button class="btn-filter us" onclick="filterMap('US')">USA (CAPEX KINGS)</button>
    <button class="btn-filter cn" onclick="filterMap('CN')">CHINA (EFFICIENT)</button>
</div>

<div class="ui-panel sidebar" id="statsPanel">
    </div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // --- 1. INTELLIGENCE DATABASE (2026 FINANCIALS) ---
    const db = [
        // === USA (THE TRILLION DOLLAR CLUB) ===
        { 
            name: "OpenAI", 
            country: "US", 
            lat: 37.76, lng: -122.42, 
            financial: "$500B Valuation", 
            detail: "Raised $6.6B (Oct '25)",
            source: "https://www.nytimes.com/2025/10/02/technology/openai-funding.html", // Placeholder for actual link logic
            tech: "o3 / GPT-5",
            desc: "Microsoft committed $13B+. The highest valued private company in history."
        },
        { 
            name: "xAI", 
            country: "US", 
            lat: 35.14, lng: -90.04, 
            financial: "$230B Valuation", 
            detail: "Raised $20B (Jan '26)",
            source: "https://fintool.com/news/xai-20-billion-series-e-nvidia-cisco", 
            tech: "Grok 3",
            desc: "Largest single round ever. Building 'Colossus' cluster in Memphis."
        },
        { 
            name: "Anthropic", 
            country: "US", 
            lat: 37.78, lng: -122.40, 
            financial: "$350B Valuation", 
            detail: "Est. Nov '25 Round",
            source: "https://techfundingnews.com/openai-anthropic-xai-ai-funding-trends-2025/", 
            tech: "Claude 3.5",
            desc: "Heavily backed by Amazon ($4B) and Google ($2B)."
        },
        { 
            name: "Google (Alphabet)", 
            country: "US", 
            lat: 37.40, lng: -122.08, 
            financial: "$132B Capex", 
            detail: "2026 Projection",
            source: "https://www.engineeringnews.co.za/article/the-new-arms-race-the-race-for-computing-power-2026-02-09", 
            tech: "Gemini / TPUs",
            desc: "Spending primarily on custom TPU infrastructure and energy."
        },
        { 
            name: "Microsoft", 
            country: "US", 
            lat: 47.67, lng: -122.12, 
            financial: "$116B Capex", 
            detail: "2026 Projection",
            source: "https://m.economictimes.com/news/international/us/tech-giants-to-spend-320-billion-on-ai-in-2025", 
            tech: "Azure AI",
            desc: "Massive data center buildout to support OpenAI & Copilot."
        },
        { 
            name: "Meta", 
            country: "US", 
            lat: 37.45, lng: -122.15, 
            financial: "$123B Capex", 
            detail: "2026 Projection",
            source: "https://www.engineeringnews.co.za/article/the-new-arms-race-the-race-for-computing-power-2026-02-09", 
            tech: "Llama 4",
            desc: "Stockpiling 600k+ H100s. Open weights strategy."
        },
        { 
            name: "Apple", 
            country: "US", 
            lat: 37.33, lng: -122.03, 
            financial: "$500B Investment", 
            detail: "US Spend (4 Yrs)",
            source: "https://www.apple.com/newsroom/2025/02/apple-will-spend-more-than-500-billion-usd-in-the-us-over-the-next-four-years/", 
            tech: "Apple Intel.",
            desc: "Focus on Private Cloud Compute and on-device silicon."
        },

        // === CHINA (THE EFFICIENCY DRIVERS) ===
        { 
            name: "DeepSeek", 
            country: "CN", 
            lat: 30.27, lng: 120.15, 
            financial: "~$10B Val (Est)", 
            detail: "Quant / HFT Backed",
            source: "https://www.sixthtone.com/news/1018017", 
            tech: "DeepSeek-R1",
            desc: "The 'Sputnik Moment'. Extremely low cost training ($6M for V3)."
        },
        { 
            name: "MiniMax", 
            country: "CN", 
            lat: 31.23, lng: 121.47, 
            financial: "$15.2B Mkt Cap", 
            detail: "IPO (HK) Jan '26",
            source: "https://www.techbuzz.ai/articles/moonshot-ai-valued-at-4-8b-in-fresh-round", 
            tech: "abab 6.5",
            desc: "Successfully IPO'd in Hong Kong. Character AI focus."
        },
        { 
            name: "Zhipu AI", 
            country: "CN", 
            lat: 40.00, lng: 116.33, 
            financial: "$13B Mkt Cap", 
            detail: "IPO (HK) Jan '26",
            source: "https://www.trendingtopics.eu/minimax-zhipu-ai-ipos/", 
            tech: "GLM-4",
            desc: "Gov-backed academic powerhouse (Tsinghua). IPO'd recently."
        },
        { 
            name: "Moonshot AI", 
            country: "CN", 
            lat: 39.92, lng: 116.45, 
            financial: "$4.8B Valuation", 
            detail: "Jan '26 Round",
            source: "https://www.cnbc.com/2026/01/19/moonshot-ai-valuation.html", 
            tech: "Kimi Chat",
            desc: "Backed by Alibaba ($1B+) and Tencent. Long-context specialist."
        },
        { 
            name: "Alibaba Cloud", 
            country: "CN", 
            lat: 30.25, lng: 120.20, 
            financial: "$200B+ (Grp)", 
            detail: "Major R&D Spend",
            source: "https://www.chelidze.group/en/post/ai-china-2025", 
            tech: "Qwen 2.5",
            desc: "Leading open-weights model in China. Massive cloud infra."
        }
    ];

    // --- 2. MAP INIT ---
    var map = L.map('map', { 
        zoomControl: false, center: [35, 175], zoom: 3, minZoom: 2, maxZoom: 10
    });

    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; OpenStreetMap, &copy; CARTO',
        subdomains: 'abcd'
    }).addTo(map);

    var markersLayer = L.layerGroup().addTo(map);

    // --- 3. RENDER LOGIC ---
    function renderMarkers(filter) {
        markersLayer.clearLayers();
        let visibleCompanies = [];

        db.forEach(co => {
            if (filter !== 'all' && co.country !== filter) return;
            visibleCompanies.push(co);

            const color = co.country === 'US' ? '#00f2ff' : '#ff3e3e';
            
            // Marker
            const icon = L.divIcon({
                className: 'custom-icon',
                html: `<div class="custom-marker" style="color:${color}; border-color:${color}; box-shadow: 0 0 10px ${color}"></div>`,
                iconSize: [12, 12],
                iconAnchor: [6, 6]
            });

            const popup = `
                <div style="font-weight:800; font-size:14px; margin-bottom:4px; color:#fff;">${co.name}</div>
                <div style="color:${color}; font-size:10px; margin-bottom:8px;">${co.country === 'US' ? 'UNITED STATES' : 'PEOPLES REPUBLIC OF CHINA'}</div>
                
                <div style="border-top:1px solid #333; padding-top:8px;">
                    <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                        <span style="color:#888;">FINANCIAL:</span>
                        <span style="color:var(--money-green); font-weight:bold;">${co.financial}</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                        <span style="color:#888;">CONTEXT:</span>
                        <span style="color:#ccc;">${co.detail}</span>
                    </div>
                     <div style="display:flex; justify-content:space-between; margin-bottom:8px;">
                        <span style="color:#888;">TECH:</span>
                        <span style="color:#fff;">${co.tech}</span>
                    </div>
                    <div style="font-size:10px; color:#999; line-height:1.3; margin-bottom:8px;">${co.desc}</div>
                    <a href="${co.source}" target="_blank" style="color:#00f2ff; font-size:9px; text-decoration:none;">üîó VERIFY SOURCE DATA</a>
                </div>
            `;

            L.marker([co.lat, co.lng], { icon: icon }).addTo(markersLayer).bindPopup(popup);
        });

        updateSidebar(visibleCompanies);
    }

    function updateSidebar(companies) {
        const panel = document.getElementById('statsPanel');
        
        // Sort by financial impact (rough heuristic for display)
        // We can't strictly sort strings like "$500B", so we'll just list them.
        // Ideally you'd parse the numbers, but for this demo list order is fine.
        
        let html = `<div class="stat-box">
            <div class="stat-label">FINANCIAL INTELLIGENCE LOG</div>
            <div style="font-size:10px; color:#666;">Sorted by Entity Relevance</div>
        </div>`;

        companies.forEach(co => {
            const color = co.country === 'US' ? 'var(--us-color)' : 'var(--cn-color)';
            html += `
                <div class="co-list-item" onclick="map.flyTo([${co.lat}, ${co.lng}], 10)">
                    <div class="co-header">
                        <span class="co-name">${co.name}</span>
                        <span class="co-money">${co.financial}</span>
                    </div>
                    <div class="co-detail">
                        <span style="color:${color}">‚óè ${co.country}</span>
                        <span>${co.detail}</span>
                        <a href="${co.source}" target="_blank" class="source-link" onclick="event.stopPropagation()">SRC</a>
                    </div>
                    <div style="margin-top:4px; font-size:10px; color:#555;">${co.tech}</div>
                </div>
            `;
        });

        panel.innerHTML = html;
    }

    // --- 4. INITIALIZE ---
    renderMarkers('all');
    
    function filterMap(type) {
        document.querySelectorAll('.btn-filter').forEach(b => b.classList.remove('active'));
        if(type === 'all') document.querySelector('.btn-filter:nth-child(2)').classList.add('active'); // child index adjusted
        if(type === 'US') document.querySelector('.btn-filter.us').classList.add('active');
        if(type === 'CN') document.querySelector('.btn-filter.cn').classList.add('active');
        renderMarkers(type);
    }

    // --- 5. VISUAL CONNECTORS (THE MONEY PIPELINES) ---
    // Connect US West Coast to East Coast (Memphis/Virginia centers usually)
    L.polyline([[37.77, -122.41], [35.14, -90.04]], { color: '#00f2ff', weight: 1, opacity: 0.1, dashArray: '5,5' }).addTo(map);
    // Connect Beijing to Shanghai/Hangzhou
    L.polyline([[39.90, 116.40], [30.27, 120.15]], { color: '#ff3e3e', weight: 1, opacity: 0.1, dashArray: '5,5' }).addTo(map);

</script>
</body>
</html>
