<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GLOBAL AI INTELLIGENCE | FULL SPECTRUM</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --us-color: #00f2ff;
            --cn-color: #ff3e3e;
            --bg-glass: rgba(5, 5, 5, 0.9);
            --border: 1px solid rgba(255, 255, 255, 0.15);
            --neon-glow: 0 0 10px rgba(0, 242, 255, 0.3);
        }

        body { margin: 0; background: #000; font-family: 'JetBrains Mono', monospace; color: #ccc; overflow: hidden; }
        
        #map { height: 100vh; width: 100vw; z-index: 1; filter: grayscale(100%) contrast(1.2); }

        /* SCANLINE EFFECT */
        body::after {
            content: " ";
            display: block;
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 2;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        /* UI PANELS */
        .ui-panel {
            position: absolute;
            z-index: 1000;
            background: var(--bg-glass);
            border: var(--border);
            backdrop-filter: blur(8px);
            padding: 15px;
        }

        /* HEADER */
        .top-bar {
            top: 20px; left: 20px; right: 20px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 2px solid #333;
        }
        .h-title { font-weight: 700; color: #fff; letter-spacing: 2px; font-size: 18px; }
        .h-live { color: #ff3e3e; animation: blink 1s infinite; font-size: 12px; }

        /* FILTER BUTTONS */
        .controls { top: 100px; left: 20px; display: flex; flex-direction: column; gap: 8px; }
        .btn-filter {
            background: rgba(255,255,255,0.05); border: 1px solid #444; color: #888;
            padding: 8px 16px; cursor: pointer; font-family: inherit; font-size: 11px;
            text-align: left; transition: 0.3s;
        }
        .btn-filter:hover, .btn-filter.active { background: #fff; color: #000; border-color: #fff; }
        .btn-filter.us.active { background: var(--us-color); border-color: var(--us-color); }
        .btn-filter.cn.active { background: var(--cn-color); border-color: var(--cn-color); }

        /* RIGHT SIDEBAR (STATS) */
        .sidebar {
            top: 100px; right: 20px; bottom: 40px; width: 340px;
            overflow-y: auto; border-left: 2px solid #333;
        }

        .stat-box { margin-bottom: 20px; }
        .stat-label { font-size: 10px; color: #666; text-transform: uppercase; margin-bottom: 5px; }
        .progress-bar { height: 4px; background: #222; width: 100%; position: relative; margin-bottom: 15px; }
        .progress-fill { height: 100%; position: absolute; transition: width 1s ease-out; }
        .p-us { background: var(--us-color); z-index: 2; }
        .p-cn { background: var(--cn-color); z-index: 1; }

        .co-list-item {
            padding: 10px; border-bottom: 1px solid #222; cursor: pointer;
            display: flex; justify-content: space-between; font-size: 12px;
        }
        .co-list-item:hover { background: rgba(255,255,255,0.05); }

        /* MAP ELEMENTS */
        .custom-marker {
            width: 8px; height: 8px; border-radius: 50%;
            background: #000; border: 2px solid #fff;
            box-shadow: 0 0 10px currentColor;
            transition: all 0.3s;
        }
        .leaflet-popup-content-wrapper {
            background: rgba(0,0,0,0.9); border: 1px solid #444; color: #fff;
            font-family: 'JetBrains Mono', monospace; font-size: 11px;
            border-radius: 0;
        }
        
        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body>

<div id="map"></div>

<div class="ui-panel top-bar">
    <div>
        <div class="h-title">AI GLOBAL WAR ROOM</div>
        <div style="font-size: 10px; color: #666;">TRACKING MAJOR FOUNDATION MODEL LABS</div>
    </div>
    <div class="h-live">● LIVE FEED</div>
</div>

<div class="ui-panel controls">
    <button class="btn-filter active" onclick="filterMap('all')">VIEW ALL UNITS</button>
    <button class="btn-filter us" onclick="filterMap('US')">USA FORCES</button>
    <button class="btn-filter cn" onclick="filterMap('CN')">CHINA FORCES</button>
</div>

<div class="ui-panel sidebar" id="statsPanel">
    </div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // --- 1. THE DATABASE ---
    // Coordinates slightly jittered to prevent perfect overlap in SF/Beijing
    const db = [
        // === USA ===
        { name: "OpenAI", country: "US", city: "San Francisco", lat: 37.76, lng: -122.42, val: 157, tech: "GPT-4o/o3", compute: "Azure (300k H100s)", desc: "The current hegemon. Heavy scaling focus." },
        { name: "Anthropic", country: "US", city: "San Francisco", lat: 37.78, lng: -122.40, val: 40, tech: "Claude 3.5", compute: "AWS Trainium", desc: "Safety-first architecture. Strong coding performance." },
        { name: "Google DeepMind", country: "US", city: "Mountain View", lat: 37.40, lng: -122.08, val: 2000, tech: "Gemini 1.5", compute: "TPU v5p", desc: "Massive internal compute infrastructure." },
        { name: "Meta FAIR", country: "US", city: "Menlo Park", lat: 37.45, lng: -122.15, val: 1200, tech: "Llama 3.1", compute: "600k H100s", desc: "Open weights champion. Setting the standard." },
        { name: "xAI", country: "US", city: "Memphis", lat: 35.14, lng: -90.04, val: 50, tech: "Grok 3", compute: "Colossus Cluster", desc: "Largest single cluster (100k H100s) in one location." },
        { name: "NVIDIA", country: "US", city: "Santa Clara", lat: 37.37, lng: -121.96, val: 3000, tech: "Nemotron", compute: "Internal DGX", desc: "The arms dealer. Developing proprietary models." },
        { name: "Microsoft", country: "US", city: "Redmond", lat: 47.67, lng: -122.12, val: 3000, tech: "Phi-3/Copilot", compute: "Azure", desc: "Focus on SLMs (Small Language Models) and Apps." },
        { name: "Apple", country: "US", city: "Cupertino", lat: 37.33, lng: -122.03, val: 3000, tech: "Apple Intel/MM1", compute: "Ajax Cluster", desc: "On-device edge AI focus." },
        
        // === CHINA ===
        { name: "DeepSeek", country: "CN", city: "Hangzhou", lat: 30.27, lng: 120.15, val: 10, tech: "DeepSeek-R1", compute: "Efficient H800", desc: "The disruptor. Shocked market with low-cost reasoning." },
        { name: "Alibaba Cloud", country: "CN", city: "Hangzhou", lat: 30.25, lng: 120.20, val: 200, tech: "Qwen 2.5", compute: "Apsara Cloud", desc: "Strongest open-weights contender from China." },
        { name: "Baidu", country: "CN", city: "Beijing", lat: 39.95, lng: 116.35, val: 40, tech: "Ernie 4.0", compute: "Kunlun Chips", desc: "The veteran. Deep integration into search/apps." },
        { name: "Tencent", country: "CN", city: "Shenzhen", lat: 22.54, lng: 113.93, val: 350, tech: "Hunyuan", compute: "Tencent Cloud", desc: "WeChat integration. Massive user base." },
        { name: "ByteDance", country: "CN", city: "Beijing", lat: 39.98, lng: 116.32, val: 220, tech: "Doubao", compute: "Internal", desc: "Algorithm kings. TikTok/Douyin integration." },
        { name: "01.AI", country: "CN", city: "Beijing", lat: 39.99, lng: 116.30, val: 1, tech: "Yi-Large", compute: "Cloud Clusters", desc: "Kai-Fu Lee's lab. Strong bilingual performance." },
        { name: "Zhipu AI", country: "CN", city: "Beijing", lat: 40.00, lng: 116.33, val: 3, tech: "GLM-4", compute: "National Grid", desc: "Academic roots (Tsinghua). Gov favorite." },
        { name: "Moonshot AI", country: "CN", city: "Beijing", lat: 39.92, lng: 116.45, val: 3, tech: "Kimi", compute: "Cloud", desc: "Long-context specialist. Top consumer app." },
        { name: "MiniMax", country: "CN", city: "Shanghai", lat: 31.23, lng: 121.47, val: 2, tech: "abab 6.5", compute: "Cloud", desc: "Focus on Character AI and RPGs." }
    ];

    // --- 2. MAP SETUP ---
    var map = L.map('map', { 
        zoomControl: false, 
        center: [30, 170], // Pacific View
        zoom: 3,
        minZoom: 2 
    });

    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
        attribution: '© OpenStreetMap, © CARTO',
        subdomains: 'abcd',
        maxZoom: 19
    }).addTo(map);

    var layerGroup = L.layerGroup().addTo(map);

    // --- 3. RENDERING FUNCTIONS ---
    function renderMarkers(filter) {
        layerGroup.clearLayers();
        
        let usCount = 0;
        let cnCount = 0;
        let visibleCompanies = [];

        db.forEach(co => {
            if (filter !== 'all' && co.country !== filter) return;

            visibleCompanies.push(co);
            if (co.country === 'US') usCount++;
            if (co.country === 'CN') cnCount++;

            const color = co.country === 'US' ? '#00f2ff' : '#ff3e3e';
            
            const icon = L.divIcon({
                className: 'custom-div-icon',
                html: `<div class="custom-marker" style="color:${color}; border-color:${color}; box-shadow: 0 0 8px ${color}"></div>`,
                iconSize: [12, 12],
                iconAnchor: [6, 6]
            });

            const popup = `
                <div style="border-bottom: 2px solid ${color}; padding-bottom: 5px; margin-bottom: 5px; font-weight: bold;">${co.name}</div>
                <div style="color: #888; margin-bottom: 8px;">${co.city}</div>
                <div style="margin-bottom: 2px;">MODEL: <span style="color:#fff">${co.tech}</span></div>
                <div style="margin-bottom: 2px;">INFRA: <span style="color:#fff">${co.compute}</span></div>
                <div style="font-size: 9px; color: #aaa; margin-top: 8px; line-height: 1.2;">${co.desc}</div>
            `;

            L.marker([co.lat, co.lng], { icon: icon })
                .bindPopup(popup)
                .on('click', () => updateSidebarHighlight(co.name))
                .addTo(layerGroup);
        });

        updateStats(visibleCompanies, usCount, cnCount);
    }

    function updateStats(companies, usCount, cnCount) {
        const panel = document.getElementById('statsPanel');
        const total = usCount + cnCount;
        const usPct = total ? (usCount / total) * 100 : 0;
        const cnPct = total ? (cnCount / total) * 100 : 0;

        let html = `
            <div class="stat-box">
                <div class="stat-label">DOMINANCE RATIO (VISIBLE UNITS)</div>
                <div class="progress-bar">
                    <div class="progress-fill p-us" style="width: ${usPct}%"></div>
                    <div class="progress-fill p-cn" style="left: ${usPct}%; width: ${cnPct}%"></div>
                </div>
                <div style="display:flex; justify-content:space-between; font-size:10px;">
                    <span style="color:var(--us-color)">USA: ${usCount} UNITS</span>
                    <span style="color:var(--cn-color)">CHN: ${cnCount} UNITS</span>
                </div>
            </div>
            
            <div class="stat-label" style="margin-top:20px; border-bottom:1px solid #333; padding-bottom:5px;">INTELLIGENCE LOG</div>
        `;

        companies.forEach(co => {
            const color = co.country === 'US' ? 'var(--us-color)' : 'var(--cn-color)';
            html += `
                <div class="co-list-item" onclick="flyTo(${co.lat}, ${co.lng})">
                    <span style="color: #fff; font-weight:bold;">${co.name}</span>
                    <span style="color: ${color}; font-family:monospace;">${co.tech}</span>
                </div>
            `;
        });

        panel.innerHTML = html;
    }

    // --- 4. INTERACTIONS ---
    function filterMap(type) {
        document.querySelectorAll('.btn-filter').forEach(b => b.classList.remove('active'));
        if(type === 'all') document.querySelector('.btn-filter:nth-child(1)').classList.add('active');
        if(type === 'US') document.querySelector('.btn-filter.us').classList.add('active');
        if(type === 'CN') document.querySelector('.btn-filter.cn').classList.add('active');
        
        renderMarkers(type);
    }

    function flyTo(lat, lng) {
        map.flyTo([lat, lng], 10, { duration: 1.5 });
    }

    function updateSidebarHighlight(name) {
        // Just a visual placeholder for future interactivity
        console.log("Intel selected: " + name);
    }

    // Initialize
    renderMarkers('all');

    // Add connectors for visual flair
    // (Simple random connecting lines between same-country nodes)
    const usNodes = db.filter(c => c.country === 'US');
    const cnNodes = db.filter(c => c.country === 'CN');

    function drawConnectors(nodes, color) {
        const group = [];
        for (let i = 0; i < nodes.length - 1; i++) {
            L.polyline([
                [nodes[i].lat, nodes[i].lng],
                [nodes[i+1].lat, nodes[i+1].lng]
            ], { color: color, weight: 1, opacity: 0.1, dashArray: '5, 10' }).addTo(map);
        }
    }

    drawConnectors(usNodes, '#00f2ff');
    drawConnectors(cnNodes, '#ff3e3e');

</script>
</body>
</html>
